load("//defs:package_defs.bzl", "ebuild_package")

# Minimal source directory for test binary
genrule(
    name = "hello-src",
    srcs = ["hello.c"],
    cmd = "mkdir -p $OUT && cp $SRCS $OUT/",
    out = "src",
    visibility = ["PUBLIC"],
)

ebuild_package(
    name = "hello",
    source = ":hello-src",
    version = "0.1.0",
    iuse = ["debug", "trace"],
    use_defaults = ["debug"],
    use_bootstrap = False,
    src_configure = "",
    src_compile = """
cc -o hello $S/hello.c
""",
    src_install = """
install -Dm755 hello "$DESTDIR/usr/bin/hello"
""",
    depend = [],
    visibility = ["PUBLIC"],
)
