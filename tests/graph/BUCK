# BXL graph structure tests.
#
# Run all tests:
#   buck2 bxl buckos//tests/graph/test_all.bxl:test_all
#
# Run individually:
#   buck2 bxl buckos//tests/graph/test_deps.bxl:test_deps
#   buck2 bxl buckos//tests/graph/test_use_flags.bxl:test_use_flags
#   buck2 bxl buckos//tests/graph/test_transforms.bxl:test_transforms
#   buck2 bxl buckos//tests/graph/test_labels.bxl:test_labels
#   buck2 bxl buckos//tests/graph/test_labels.bxl:test_label_coverage
#   buck2 bxl buckos//tests/graph/test_versions.bxl:test_versions
#   buck2 bxl buckos//tests/graph/test_targets.bxl:test_targets
#   buck2 bxl buckos//tests/graph/test_provenance.bxl:test_provenance
#   buck2 bxl buckos//tests/graph/test_graph.bxl:test_graph
#   buck2 bxl buckos//tests/graph/test_cloud_hypervisor.bxl:test_cloud_hypervisor
#   buck2 bxl buckos//tests/graph/test_dedup.bxl:test_dedup
#   buck2 bxl buckos//tests/graph/test_bootstrap_isolation.bxl:test_bootstrap_isolation
#   buck2 bxl buckos//tests/graph/test_hermiticity.bxl:test_hermiticity
#
# Static analysis (no buck2 needed):
#   python3 tests/graph/verify_package_completeness.py
#   buck2 test //tests/graph:test-package-completeness

# ── Static analysis: package() completeness check ────────────────────

sh_test(
    name = "test-package-completeness",
    test = "verify_package_completeness.py",
    labels = ["graph"],
)

# ── BXL test file exports ────────────────────────────────────────────

export_file(
    name = "test_all.bxl",
    src = "test_all.bxl",
    visibility = ["PUBLIC"],
)

export_file(
    name = "test_deps.bxl",
    src = "test_deps.bxl",
    visibility = ["PUBLIC"],
)

export_file(
    name = "test_use_flags.bxl",
    src = "test_use_flags.bxl",
    visibility = ["PUBLIC"],
)

export_file(
    name = "test_transforms.bxl",
    src = "test_transforms.bxl",
    visibility = ["PUBLIC"],
)

export_file(
    name = "test_labels.bxl",
    src = "test_labels.bxl",
    visibility = ["PUBLIC"],
)

export_file(
    name = "test_versions.bxl",
    src = "test_versions.bxl",
    visibility = ["PUBLIC"],
)

export_file(
    name = "test_targets.bxl",
    src = "test_targets.bxl",
    visibility = ["PUBLIC"],
)

export_file(
    name = "test_provenance.bxl",
    src = "test_provenance.bxl",
    visibility = ["PUBLIC"],
)

export_file(
    name = "test_graph.bxl",
    src = "test_graph.bxl",
    visibility = ["PUBLIC"],
)

export_file(
    name = "test_cloud_hypervisor.bxl",
    src = "test_cloud_hypervisor.bxl",
    visibility = ["PUBLIC"],
)

export_file(
    name = "test_dedup.bxl",
    src = "test_dedup.bxl",
    visibility = ["PUBLIC"],
)

export_file(
    name = "test_bootstrap_isolation.bxl",
    src = "test_bootstrap_isolation.bxl",
    visibility = ["PUBLIC"],
)

export_file(
    name = "test_hermiticity.bxl",
    src = "test_hermiticity.bxl",
    visibility = ["PUBLIC"],
)
