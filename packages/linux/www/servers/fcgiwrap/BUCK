load("//defs:package.bzl", "package")

# fcgiwrap - Simple FastCGI wrapper for CGI scripts
#
# fcgiwrap is a simple server for running CGI applications over FastCGI.
# It works great with nginx and other web servers that support FastCGI.
#
# It's especially useful for hosting legacy CGI scripts or git repositories
# over HTTP.

package(
    build_rule = "autotools",
    name = "fcgiwrap",
    # Disable -Werror for implicit-fallthrough warning
    env = {"CFLAGS": "-O2 -Wno-implicit-fallthrough"},
    pre_configure_cmds = ["""
autoreconf -fiv
"""],
    version = "1.1.0",
    use_configure = {
        "systemd": ("--with-systemd", "--without-systemd"),
    },
    use_deps = {
        "systemd": "//packages/linux/system/init/systemd:systemd",
    },
    url = "https://github.com/gnosek/fcgiwrap/archive/refs/tags/1.1.0.tar.gz",
    sha256 = "4c7de0db2634c38297d5fcef61ab4a3e21856dd7247d49c33d9b19542bd1c61f",
    description = "Simple FastCGI wrapper for CGI scripts",
    homepage = "https://github.com/gnosek/fcgiwrap",
    license = "MIT",
    deps = [
        "//packages/linux/www/servers/fcgi:fcgi",
                "//packages/linux/dev-tools/build-systems/autoconf:autoconf",
                "//packages/linux/dev-tools/build-systems/automake:automake",
                "//packages/linux/dev-tools/build-systems/libtool:libtool",
                "//packages/linux/dev-tools/build-systems/pkg-config:pkg-config"
    ],
    configure_args = [
        "--prefix=${PREFIX}",
    ],
)
