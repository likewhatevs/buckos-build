load("@root//defs:package_defs.bzl", "cmake_package")

# MikkTSpace - Tangent Space Normal Maps library
# A library for generating tangent spaces for normal mapping

cmake_package(
    name = "mikktspace",
    version = "1.0",
    src_uri = "https://github.com/mmikk/MikkTSpace/archive/refs/heads/master.tar.gz",
    sha256 = "a07fb76cee5e5e08be84086462b9377b92cb369c878d953f32ca2e69b44cbd3b",
    description = "Tangent space calculation library for normal mapping",
    homepage = "https://github.com/mmikk/MikkTSpace",
    license = "Zlib",
    deps = [],
    cmake_args = [
        "-DCMAKE_BUILD_TYPE=Release",
        "-DBUILD_SHARED_LIBS=ON",
    ],
    pre_configure = """
        # Create CMakeLists.txt for this simple C library
        cat > CMakeLists.txt << 'EOF'
cmake_minimum_required(VERSION 3.10)
project(mikktspace C)

# Add the library
add_library(mikktspace SHARED mikktspace.c)

# Set compiler flags
target_compile_options(mikktspace PRIVATE -Wno-shadow)

# Install library and headers
install(TARGETS mikktspace
    LIBRARY DESTINATION lib
    ARCHIVE DESTINATION lib)

install(FILES mikktspace.h
    DESTINATION include)
EOF
    """,
    visibility = ["PUBLIC"],
)
