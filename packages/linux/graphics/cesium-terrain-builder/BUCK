load("//defs:package.bzl", "package")

# Cesium Terrain Builder - Tools for creating terrain tiles for Cesium
#
# Cesium Terrain Builder is a C++ library and set of associated command line
# tools for creating terrain tiles for use in the Cesium JavaScript library.
# The tools can be used to create terrain tiles from GeoTIFF data, GDAL raster
# formats, and other geospatial data sources.

package(
    build_rule = "cmake",
    name = "cesium-terrain-builder",
    version = "0.4.1",
    url = "https://mirror.buckos.org/c/cesium-terrain-builder-v0.4.1.tar.gz",
    sha256 = "41c2155c9ceb2c2946a260efe5840b2d5a696df05b7a0cc1703f7fd098469e94",
    description = "Tools for creating terrain tiles for Cesium - converts geospatial data to Cesium terrain format",
    homepage = "https://github.com/ruanqizhen/cesium-terrain-builder",
    license = "Apache-2.0",
    deps = [
        # GDAL >= 2.0.0 required (RFC 46 unified GDAL/OGR API)
        # TODO: Add GDAL dependency when available
        # "//packages/linux/graphics/gdal:gdal",

        # zlib required for terrain tile compression
        "//packages/linux/core/zlib:zlib",

        # Note: Threads library (pthread) is provided by system toolchain
    ],
    configure_args = [
        "-DCMAKE_BUILD_TYPE=Release",
        "-DBUILD_SHARED_LIBS=ON",
        # Tile size - according to spec should always be 65
        "-DTERRAIN_TILE_SIZE=65",
        # Water mask size - according to spec should always be 256
        "-DTERRAIN_MASK_SIZE=256",
    ],
    visibility = ["PUBLIC"],
)
