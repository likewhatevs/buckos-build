load("//defs:package.bzl", "package")

package(
    build_rule = "autotools",
    name = "cformers",
    version = "0.0.1",
    url = "https://github.com/nolanoorg/cformers/archive/afa8b155e3b6c68cf6d100b93769ae61ff31927c.tar.gz",
    sha256 = "1871e3c79ca3e4114fd5aa26f3899bb49212b9d32ec90621ec3508274bec0dbf",
    description = "C/C++ implementation for running transformer models",
    homepage = "https://github.com/nolanoorg/cformers",
    license = "MIT",
    post_install_cmds = ["""\
mkdir -p "$DESTDIR/usr/bin"
cd cformers/cpp
install -m 755 main "$DESTDIR/usr/bin/cformers"
install -m 755 quantize_bloom "$DESTDIR/usr/bin/cformers-quantize-bloom"
install -m 755 quantize_gptj "$DESTDIR/usr/bin/cformers-quantize-gptj"
install -m 755 quantize_gpt2 "$DESTDIR/usr/bin/cformers-quantize-gpt2"
install -m 755 quantize_gptneox "$DESTDIR/usr/bin/cformers-quantize-gptneox"
"""],
)
