load("//defs:package.bzl", "package")

package(
    build_rule = "autotools",
    name = "openocd",
    version = "0.12.0",
    use_configure = {
        "capstone": ("--enable-capstone", "--disable-capstone"),
        "cmsis-dap": ("--enable-cmsis-dap", "--disable-cmsis-dap"),
        "dummy": ("--enable-dummy", "--disable-dummy"),
        "ftdi": ("--enable-ftdi", "--disable-ftdi"),
        "gpiod": ("--enable-gpiod", "--disable-gpiod"),
        "jlink": ("--enable-jlink", "--disable-jlink"),
        "parport": ("--enable-parport", "--disable-parport"),
        "usb": ("--enable-usb", "--disable-usb"),
        "verbose-io": ("--enable-verbose-io", "--disable-verbose-io"),
    },
    url = "https://downloads.sourceforge.net/project/openocd/openocd/0.12.0/openocd-0.12.0.tar.gz",
    sha256 = "bb367fd19ab96a65ee5b269b60326d9f36bca1c64d9865cc36985d3651aba563",
    description = "Open On-Chip Debugger - JTAG/SWD debugger for embedded systems",
    homepage = "https://openocd.org/",
    license = "GPL-2.0",
    configure_args = [
        "--prefix=/usr",
        "--disable-werror",
    ],
    deps = [
        "//packages/linux/system/libs/libusb:libusb",
        "//packages/linux/system/libs/libftdi:libftdi",
    ],
)
