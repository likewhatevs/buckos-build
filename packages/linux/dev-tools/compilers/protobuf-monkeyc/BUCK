load("@root//defs:package_defs.bzl", "go_package")

go_package(
    name = "protobuf-monkeyc",
    version = "0.0.0",
    src_uri = "https://github.com/domenipavec/protobuf-monkeyc/archive/refs/heads/main.tar.gz",
    sha256 = "989406521912cb14c786b1c1ce8b9b6ca556f0e4b8e93c9fd76dc9d7fd2eedb6",
    bins = ["protoc-gen-monkeyc"],
    packages = ["."],
    src_prepare = """
if [ -d protoc-gen-monkeyc ] && [ -f protoc-gen-monkeyc/go.mod ]; then
    cp -rT protoc-gen-monkeyc .
    rm -rf protoc-gen-monkeyc
fi
rm -rf .git
""",
    description = "Protobuf compiler plugin for generating Garmin Monkey C code",
    homepage = "https://github.com/domenipavec/protobuf-monkeyc",
    license = "MIT",
    visibility = ["PUBLIC"],
)
