load("//defs:package.bzl", "package")

# asciidoc - Python package
# USE flags: doc, test
# Default: none

package(
    build_rule = "python",
    name = "asciidoc",
    version = "10.2.0",
    url = "https://github.com/asciidoc-py/asciidoc-py/releases/download/10.2.0/asciidoc-10.2.0.tar.gz",
    sha256 = "237b2ba5c35c0ae7ccd4cd44ebf1d87c20b2695dae01798954416d492ef7fa0e",
    description = "Text based document generation",
    homepage = "https://asciidoc.org/",
    license = "GPL-2+",
    # asciidoc/resources/ subdirs lack __init__.py; setuptools 75+ treats
    # the find_packages/find_namespace_packages mismatch as an error.
    # Switch to find_namespace_packages so all resource dirs are included.
    pre_configure_cmds = [
        "sed -i 's/from setuptools import find_packages/from setuptools import find_namespace_packages as find_packages/' setup.py",
        "rm -rf build asciidoc.egg-info",
    ],
    deps = [
        "//packages/linux/dev-libs/python/setuptools:setuptools",
    ],
)
