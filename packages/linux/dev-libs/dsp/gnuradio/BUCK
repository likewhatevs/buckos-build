load("//defs:package.bzl", "package")

# GNU Radio - Free & open-source software development toolkit for SDR
# Provides signal processing blocks for software-defined radios
package(
    build_rule = "cmake",
    name = "gnuradio",
    version = "3.10.9.2",
    url = "https://github.com/gnuradio/gnuradio/archive/refs/tags/v3.10.9.2.tar.gz",
    sha256 = "7fa154c423d01494cfa4c739faabad70b97f605238cd3fea8907b345b421fea1",
    configure_args = [
        "-DENABLE_TESTING=OFF",
        "-DENABLE_DOXYGEN=OFF",
        "-DENABLE_SPHINX=OFF",
    ],
    use_configure = {
        "alsa": ("-DENABLE_ALSA=ON", "-DENABLE_ALSA=OFF"),
        "analog": ("-DENABLE_ANALOG=ON", "-DENABLE_ANALOG=OFF"),
        "channels": ("-DENABLE_CHANNELS=ON", "-DENABLE_CHANNELS=OFF"),
        "ctrlport": ("-DENABLE_CTRLPORT=ON", "-DENABLE_CTRLPORT=OFF"),
        "digital": ("-DENABLE_DIGITAL=ON", "-DENABLE_DIGITAL=OFF"),
        "dtv": ("-DENABLE_DTV=ON", "-DENABLE_DTV=OFF"),
        "examples": ("-DBUILD_EXAMPLES=ON", "-DBUILD_EXAMPLES=OFF"),
        "fec": ("-DENABLE_FEC=ON", "-DENABLE_FEC=OFF"),
        "filter": ("-DENABLE_FILTER=ON", "-DENABLE_FILTER=OFF"),
        "iio": ("-DENABLE_IIO=ON", "-DENABLE_IIO=OFF"),
        "jack": ("-DENABLE_JACK=ON", "-DENABLE_JACK=OFF"),
        "modtool": ("-DENABLE_MODTOOL=ON", "-DENABLE_MODTOOL=OFF"),
        "network": ("-DENABLE_NETWORK=ON", "-DENABLE_NETWORK=OFF"),
        "oss": ("-DENABLE_OSS=ON", "-DENABLE_OSS=OFF"),
        "performance-counters": ("-DENABLE_PERFORMANCE_COUNTERS=ON", "-DENABLE_PERFORMANCE_COUNTERS=OFF"),
        "portaudio": ("-DENABLE_PORTAUDIO=ON", "-DENABLE_PORTAUDIO=OFF"),
        "qt5": ("-DENABLE_QT5=ON", "-DENABLE_QT5=OFF"),
        "sdl": ("-DENABLE_SDL=ON", "-DENABLE_SDL=OFF"),
        "soapy": ("-DENABLE_SOAPY=ON", "-DENABLE_SOAPY=OFF"),
        "trellis": ("-DENABLE_TRELLIS=ON", "-DENABLE_TRELLIS=OFF"),
        "utils": ("-DENABLE_UTILS=ON", "-DENABLE_UTILS=OFF"),
        "vocoder": ("-DENABLE_VOCODER=ON", "-DENABLE_VOCODER=OFF"),
        "wavelet": ("-DENABLE_WAVELET=ON", "-DENABLE_WAVELET=OFF"),
    },
    use_deps = {
        "python": [
            "//packages/linux/lang/python:python3",
        ],
        "audio": [
            "//packages/linux/media/sound/alsa-lib:alsa-lib",
        ],
        "zeromq": [
            "//packages/linux/network/messaging/zeromq:zeromq",
        ],
    },
    deps = [
        "//packages/linux/dev-libs/boost:boost",
        "//packages/linux/dev-libs/math/fftw:fftw",
        "//packages/linux/core/gmp:gmp",
        "//packages/linux/system/libs/utility/mpfr:mpfr",
    ],
    description = "GNU Radio software-defined radio toolkit",
    homepage = "https://www.gnuradio.org/",
    license = "GPL-3.0-or-later",
)
