load("@root//defs:package_defs.bzl", "cmake_package")

# GNU Radio - Free & open-source software development toolkit for SDR
# Provides signal processing blocks for software-defined radios
cmake_package(
    name = "gnuradio",
    version = "3.10.9.2",
    src_uri = "https://github.com/gnuradio/gnuradio/archive/refs/tags/v3.10.9.2.tar.gz",
    sha256 = "7fa154c423d01494cfa4c739faabad70b97f605238cd3fea8907b345b421fea1",
    cmake_args = [
        "-DENABLE_TESTING=OFF",
        "-DENABLE_DOXYGEN=OFF",
        "-DENABLE_SPHINX=OFF",
    ],
    iuse = [
        "alsa",
        "analog",
        "audio",
        "channels",
        "ctrlport",
        "digital",
        "dtv",
        "examples",
        "fec",
        "filter",
        "grc",
        "iio",
        "jack",
        "modtool",
        "network",
        "oss",
        "performance-counters",
        "portaudio",
        "python",
        "qt5",
        "qtgui",
        "sdl",
        "soapy",
        "trellis",
        "uhd",
        "utils",
        "vocoder",
        "wavelet",
        "zeromq",
    ],
    use_cmake = {
        "-alsa": "-DENABLE_ALSA=OFF",
        "-analog": "-DENABLE_ANALOG=OFF",
        "-channels": "-DENABLE_CHANNELS=OFF",
        "-ctrlport": "-DENABLE_CTRLPORT=OFF",
        "-digital": "-DENABLE_DIGITAL=OFF",
        "-dtv": "-DENABLE_DTV=OFF",
        "-examples": "-DBUILD_EXAMPLES=OFF",
        "-fec": "-DENABLE_FEC=OFF",
        "-filter": "-DENABLE_FILTER=OFF",
        "-iio": "-DENABLE_IIO=OFF",
        "-jack": "-DENABLE_JACK=OFF",
        "-modtool": "-DENABLE_MODTOOL=OFF",
        "-network": "-DENABLE_NETWORK=OFF",
        "-oss": "-DENABLE_OSS=OFF",
        "-performance-counters": "-DENABLE_PERFORMANCE_COUNTERS=OFF",
        "-portaudio": "-DENABLE_PORTAUDIO=OFF",
        "-qt5": "-DENABLE_QT5=OFF",
        "-sdl": "-DENABLE_SDL=OFF",
        "-soapy": "-DENABLE_SOAPY=OFF",
        "-trellis": "-DENABLE_TRELLIS=OFF",
        "-utils": "-DENABLE_UTILS=OFF",
        "-vocoder": "-DENABLE_VOCODER=OFF",
        "-wavelet": "-DENABLE_WAVELET=OFF",
        "alsa": "-DENABLE_ALSA=ON",
        "analog": "-DENABLE_ANALOG=ON",
        "channels": "-DENABLE_CHANNELS=ON",
        "ctrlport": "-DENABLE_CTRLPORT=ON",
        "digital": "-DENABLE_DIGITAL=ON",
        "dtv": "-DENABLE_DTV=ON",
        "examples": "-DBUILD_EXAMPLES=ON",
        "fec": "-DENABLE_FEC=ON",
        "filter": "-DENABLE_FILTER=ON",
        "iio": "-DENABLE_IIO=ON",
        "jack": "-DENABLE_JACK=ON",
        "modtool": "-DENABLE_MODTOOL=ON",
        "network": "-DENABLE_NETWORK=ON",
        "oss": "-DENABLE_OSS=ON",
        "performance-counters": "-DENABLE_PERFORMANCE_COUNTERS=ON",
        "portaudio": "-DENABLE_PORTAUDIO=ON",
        "qt5": "-DENABLE_QT5=ON",
        "sdl": "-DENABLE_SDL=ON",
        "soapy": "-DENABLE_SOAPY=ON",
        "trellis": "-DENABLE_TRELLIS=ON",
        "utils": "-DENABLE_UTILS=ON",
        "vocoder": "-DENABLE_VOCODER=ON",
        "wavelet": "-DENABLE_WAVELET=ON",
    },
    use_defaults = ["python"],
    use_options = {
        "python": "ENABLE_PYTHON",
        "uhd": "ENABLE_GR_UHD",
        "audio": "ENABLE_GR_AUDIO",
        "qtgui": "ENABLE_GR_QTGUI",
        "grc": "ENABLE_GRC",
        "zeromq": "ENABLE_GR_ZEROMQ",
    },
    use_deps = {
        "python": [
            "//packages/linux/lang/python:python3",
        ],
        "audio": [
            "//packages/linux/media/sound/alsa-lib:alsa-lib",
        ],
        "zeromq": [
            "//packages/linux/network/messaging/zeromq:zeromq",
        ],
    },
    deps = [
        "//packages/linux/dev-libs/boost:boost",
        "//packages/linux/dev-libs/fftw:fftw",
        "//packages/linux/core/gmp:gmp",
        "//packages/linux/dev-libs/mpfr:mpfr",
    ],
    description = "GNU Radio software-defined radio toolkit",
    homepage = "https://www.gnuradio.org/",
    license = "GPL-3.0-or-later",
    maintainers = ["buckos"],
    visibility = ["PUBLIC"],
)
