load("@root//defs:package_defs.bzl", "download_source", "cmake_package")

download_source(
    name = "librsync-src",
    src_uri = "https://github.com/librsync/librsync/releases/download/v2.3.2/librsync-2.3.2.tar.gz",
    sha256 = "ef8ce23df38d5076d25510baa2cabedffbe0af460d887d86c2413a1c2b0c676f",
    signature_required = False,
)

cmake_package(
    name = "librsync",
    source = ":librsync-src",
    version = "2.3.2",
    description = "Library for delta compression and synchronization",
    homepage = "https://librsync.github.io/",
    license = "LGPL-2.1",
    cmake_args = [
        "-DBUILD_SHARED_LIBS=ON",
        "-DENABLE_COMPRESSION=OFF",
        "-DUSE_LIBB2=OFF",
    ],
    deps = [
        "//packages/linux/system/libs/ipc/popt:popt",
    ],
    visibility = ["PUBLIC"],
)
