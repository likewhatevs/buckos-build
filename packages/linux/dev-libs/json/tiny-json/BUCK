load("//defs:package_defs.bzl", "cmake_package")

cmake_package(
    name = "tiny-json",
    version = "1.0.0",
    src_uri = "https://github.com/rafagafe/tiny-json/archive/025cdde5f2574290d8b2a8524bc257db2829bb7c.tar.gz",
    sha256 = "af663dcb8a49f472be11864e22b55e6501b4b6bbe7f7b0d8a51a20cfa9b2a522",
    description = "Versatile and easy to use json parser for embedded systems",
    homepage = "https://github.com/rafagafe/tiny-json",
    license = "MIT",
    deps = [],
    pre_configure = """
cat > CMakeLists.txt << 'EOF'
cmake_minimum_required(VERSION 3.10)
project(tiny-json C)

add_library(tiny-json tiny-json.c)
target_include_directories(tiny-json PUBLIC
    $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}>
    $<INSTALL_INTERFACE:include>
)

install(TARGETS tiny-json
    LIBRARY DESTINATION lib
    ARCHIVE DESTINATION lib
)
install(FILES tiny-json.h DESTINATION include)
EOF
""",
    cmake_args = [
        "-DCMAKE_BUILD_TYPE=Release",
    ],
    visibility = ["PUBLIC"],
)
