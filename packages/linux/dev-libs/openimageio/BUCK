load("@root//defs:package_defs.bzl", "cmake_package", "autotools_package")
load("@root//defs:use_flags.bzl", "set_use_flags")

# openimageio - Library for reading and writing images
cmake_package(
    name = "openimageio",
    version = "2.5.10.1",
    iuse = [
        "cuda",
        "debug",
        "dicom",
        "ffmpeg",
        "fits",
        "gif",
        "gui",
        "jpeg2k",
        "jpegxl",
        "libcxx",
        "opencv",
        "openvdb",
        "ptex",
        "python",
        "raw",
        "tools",
        "truetype",
    ],
    use_cmake = {
        "-cuda": "-DWITH_CUDA=OFF",
        "-debug": "-DCMAKE_BUILD_TYPE=Release",
        "-dicom": "-DENABLE_DICOM=OFF",
        "-ffmpeg": "-DENABLE_FFMPEG=OFF",
        "-fits": "-DENABLE_FITS=OFF",
        "-gif": "-DENABLE_GIF=OFF",
        "-gui": "-DENABLE_GUI=OFF",
        "-jpeg2k": "-DENABLE_JPEG2K=OFF",
        "-jpegxl": "-DENABLE_JPEGXL=OFF",
        "-libcxx": "-DENABLE_LIBCXX=OFF",
        "-opencv": "-DENABLE_OPENCV=OFF",
        "-openvdb": "-DENABLE_OPENVDB=OFF",
        "-ptex": "-DENABLE_PTEX=OFF",
        "-python": "-DENABLE_PYTHON=OFF",
        "-raw": "-DENABLE_RAW=OFF",
        "-tools": "-DENABLE_TOOLS=OFF",
        "-truetype": "-DENABLE_TRUETYPE=OFF",
        "cuda": "-DWITH_CUDA=ON",
        "debug": "-DCMAKE_BUILD_TYPE=Debug",
        "dicom": "-DENABLE_DICOM=ON",
        "ffmpeg": "-DENABLE_FFMPEG=ON",
        "fits": "-DENABLE_FITS=ON",
        "gif": "-DENABLE_GIF=ON",
        "gui": "-DENABLE_GUI=ON",
        "jpeg2k": "-DENABLE_JPEG2K=ON",
        "jpegxl": "-DENABLE_JPEGXL=ON",
        "libcxx": "-DENABLE_LIBCXX=ON",
        "opencv": "-DENABLE_OPENCV=ON",
        "openvdb": "-DENABLE_OPENVDB=ON",
        "ptex": "-DENABLE_PTEX=ON",
        "python": "-DENABLE_PYTHON=ON",
        "raw": "-DENABLE_RAW=ON",
        "tools": "-DENABLE_TOOLS=ON",
        "truetype": "-DENABLE_TRUETYPE=ON",
    },
    src_uri = "https://github.com/OpenImageIO/oiio/archive/v2.5.10.1.tar.gz",
    sha256 = "8f6a547f6a5d510737ba436f867043db537def65f0fdb14ec30e5a185b619f93",
    signature_required = False,
    description = "Library for reading and writing images, and a bunch of related classes, utilities, and applications",
    homepage = "https://openimageio.org/",
    license = "Apache-2.0",
    cmake_args = [
        "-DBUILD_SHARED_LIBS=ON",
        "-DOIIO_BUILD_TESTS=OFF",
        "-DUSE_PYTHON=OFF",
        "-DUSE_QT=OFF",
    ],
    deps = [
        "//packages/linux/dev-libs/boost:boost",
        "//packages/linux/dev-libs/openexr:openexr",
    ],
    visibility = ["PUBLIC"],
)
