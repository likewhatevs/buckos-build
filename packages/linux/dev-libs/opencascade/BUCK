load("@root//defs:package_defs.bzl", "cmake_package", "autotools_package")
load("@root//defs:use_flags.bzl", "set_use_flags")

# opencascade - Open CASCADE Technology - 3D modeling & numerical simulation
# Use GitHub mirror since git.dev.opencascade.org often times out
cmake_package(
    name = "opencascade",
    version = "7.7.2",
    iuse = [
        "X",
        "debug",
        "freeimage",
        "gles2",
        "jemalloc",
        "json",
        "opengl",
        "optimize",
        "tbb",
        "testprograms",
        "tk",
        "truetype",
        "vtk",
    ],
    use_cmake = {
        "-X": "-DENABLE_X=OFF",
        "-debug": "-DCMAKE_BUILD_TYPE=Release",
        "-freeimage": "-DENABLE_FREEIMAGE=OFF",
        "-gles2": "-DENABLE_GLES2=OFF",
        "-jemalloc": "-DENABLE_JEMALLOC=OFF",
        "-json": "-DENABLE_JSON=OFF",
        "-opengl": "-DENABLE_OPENGL=OFF",
        "-optimize": "-DENABLE_OPTIMIZE=OFF",
        "-tbb": "-DENABLE_TBB=OFF",
        "-testprograms": "-DENABLE_TESTPROGRAMS=OFF",
        "-tk": "-DENABLE_TK=OFF",
        "-truetype": "-DENABLE_TRUETYPE=OFF",
        "-vtk": "-DENABLE_VTK=OFF",
        "X": "-DENABLE_X=ON",
        "debug": "-DCMAKE_BUILD_TYPE=Debug",
        "freeimage": "-DENABLE_FREEIMAGE=ON",
        "gles2": "-DENABLE_GLES2=ON",
        "jemalloc": "-DENABLE_JEMALLOC=ON",
        "json": "-DENABLE_JSON=ON",
        "opengl": "-DENABLE_OPENGL=ON",
        "optimize": "-DENABLE_OPTIMIZE=ON",
        "tbb": "-DENABLE_TBB=ON",
        "testprograms": "-DENABLE_TESTPROGRAMS=ON",
        "tk": "-DENABLE_TK=ON",
        "truetype": "-DENABLE_TRUETYPE=ON",
        "vtk": "-DENABLE_VTK=ON",
    },
    src_uri = "https://github.com/Open-Cascade-SAS/OCCT/archive/refs/tags/V7_7_2.tar.gz",
    sha256 = "0b3cce50b859cd2ed6809fab0de2eb8c8424768bdb6307834766bad0b583605b",
    signature_required = False,
    description = "Open CASCADE Technology - development platform for 3D CAD/CAM/CAE",
    homepage = "https://dev.opencascade.org/",
    license = "LGPL-2.1-or-later",
    cmake_args = [
        "-DBUILD_SHARED_LIBS=ON",
        "-DBUILD_MODULE_Draw=OFF",
        "-DBUILD_DOC_Overview=OFF",
        "-DINSTALL_TEST_CASES=OFF",
    ],
    deps = [],
    visibility = ["PUBLIC"],
)
