load("@root//defs:package_defs.bzl", "cmake_package")

# HDF5 - High-performance data management and storage suite

cmake_package(
    name = "hdf5",
    version = "1.14.3",
    src_uri = "https://github.com/HDFGroup/hdf5/archive/refs/tags/hdf5-1_14_3.tar.gz",
    sha256 = "df5ee33c74d5efb59738075ef96f4201588e1f1eeb233f047ac7fd1072dee1f6",
    description = "High-performance data management and storage suite",
    homepage = "https://www.hdfgroup.org/solutions/hdf5/",
    license = "BSD-3-Clause",
    iuse = [
        "cxx",
        "debug",
        "fortran",
        "hl",
        "mpi",
        "parallel",
        "szip",
        "threads",
        "threadsafe",
        "unsupported",
        "zlib",
    ],
    use_defaults = ["cxx", "threadsafe"],
    deps = [
        "core//zlib:zlib",
    ],
    cmake_args = [
        "-DCMAKE_BUILD_TYPE=Release",
        "-DBUILD_SHARED_LIBS=ON",
        "-DHDF5_BUILD_EXAMPLES=OFF",
        "-DHDF5_BUILD_TOOLS=ON",
        "-DBUILD_TESTING=OFF",
    ],
    use_cmake = {
        "-cxx": "-DHDF5_BUILD_CPP_LIB=OFF",
        "-debug": "-DCMAKE_BUILD_TYPE=Release",
        "-fortran": "-DHDF5_BUILD_FORTRAN=OFF",
        "-hl": "-DENABLE_HL=OFF",
        "-mpi": "-DENABLE_MPI=OFF",
        "-parallel": "-DHDF5_ENABLE_PARALLEL=OFF",
        "-szip": "-DENABLE_SZIP=OFF",
        "-threads": "-DENABLE_THREADS=OFF",
        "-threadsafe": "-DHDF5_ENABLE_THREADSAFE=OFF",
        "-unsupported": "-DENABLE_UNSUPPORTED=OFF",
        "-zlib": "-DENABLE_ZLIB=OFF",
        "cxx": "-DHDF5_BUILD_CPP_LIB=ON",
        "debug": "-DCMAKE_BUILD_TYPE=Debug",
        "fortran": "-DHDF5_BUILD_FORTRAN=ON",
        "hl": "-DENABLE_HL=ON",
        "mpi": "-DENABLE_MPI=ON",
        "parallel": "-DHDF5_ENABLE_PARALLEL=ON",
        "szip": "-DENABLE_SZIP=ON",
        "threads": "-DENABLE_THREADS=ON",
        "threadsafe": "-DHDF5_ENABLE_THREADSAFE=ON",
        "unsupported": "-DENABLE_UNSUPPORTED=ON",
        "zlib": "-DENABLE_ZLIB=ON",
    },
    visibility = ["PUBLIC"],
)
