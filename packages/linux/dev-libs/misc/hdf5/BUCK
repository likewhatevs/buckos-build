load("//defs:package.bzl", "package")

# HDF5 - High-performance data management and storage suite

package(
    build_rule = "cmake",
    name = "hdf5",
    version = "1.14.3",
    url = "https://github.com/HDFGroup/hdf5/archive/refs/tags/hdf5-1_14_3.tar.gz",
    sha256 = "df5ee33c74d5efb59738075ef96f4201588e1f1eeb233f047ac7fd1072dee1f6",
    description = "High-performance data management and storage suite",
    homepage = "https://www.hdfgroup.org/solutions/hdf5/",
    license = "BSD-3-Clause",
    deps = [
        "//packages/linux/core/zlib:zlib",
    ],
    configure_args = [
        "-DCMAKE_BUILD_TYPE=Release",
        "-DBUILD_SHARED_LIBS=ON",
        "-DHDF5_BUILD_EXAMPLES=OFF",
        "-DHDF5_BUILD_TOOLS=ON",
        "-DBUILD_TESTING=OFF",
    ],
    use_configure = {
        "cxx": ("-DHDF5_BUILD_CPP_LIB=ON", "-DHDF5_BUILD_CPP_LIB=OFF"),
        "debug": ("-DCMAKE_BUILD_TYPE=Debug", "-DCMAKE_BUILD_TYPE=Release"),
        "fortran": ("-DHDF5_BUILD_FORTRAN=ON", "-DHDF5_BUILD_FORTRAN=OFF"),
        "hl": ("-DENABLE_HL=ON", "-DENABLE_HL=OFF"),
        "mpi": ("-DENABLE_MPI=ON", "-DENABLE_MPI=OFF"),
        "parallel": ("-DHDF5_ENABLE_PARALLEL=ON", "-DHDF5_ENABLE_PARALLEL=OFF"),
        "szip": ("-DENABLE_SZIP=ON", "-DENABLE_SZIP=OFF"),
        "threads": ("-DENABLE_THREADS=ON", "-DENABLE_THREADS=OFF"),
        "threadsafe": ("-DHDF5_ENABLE_THREADSAFE=ON", "-DHDF5_ENABLE_THREADSAFE=OFF"),
        "unsupported": ("-DENABLE_UNSUPPORTED=ON", "-DENABLE_UNSUPPORTED=OFF"),
        "zlib": ("-DENABLE_ZLIB=ON", "-DENABLE_ZLIB=OFF"),
    },
)
