load("@root//defs:package_defs.bzl", "autotools_package")

autotools_package(
    name = "google-perftools",
    version = "2.6.1",
    iuse = [
        "debug",
        "llvm-libunwind",
        "minimal",
        "optimisememory",
        "pagesize-128k",
        "pagesize-16k",
        "pagesize-256k",
        "pagesize-32k",
        "pagesize-64k",
        "static-libs",
    ],
    use_configure = {
        "-debug": "--disable-debug",
        "-llvm-libunwind": "--disable-llvm-libunwind",
        "-minimal": "--disable-minimal",
        "-optimisememory": "--disable-optimisememory",
        "-pagesize-128k": "--disable-pagesize-128k",
        "-pagesize-16k": "--disable-pagesize-16k",
        "-pagesize-256k": "--disable-pagesize-256k",
        "-pagesize-32k": "--disable-pagesize-32k",
        "-pagesize-64k": "--disable-pagesize-64k",
        "-static-libs": "--disable-static",
        "debug": "--enable-debug",
        "llvm-libunwind": "--enable-llvm-libunwind",
        "minimal": "--enable-minimal",
        "optimisememory": "--enable-optimisememory",
        "pagesize-128k": "--enable-pagesize-128k",
        "pagesize-16k": "--enable-pagesize-16k",
        "pagesize-256k": "--enable-pagesize-256k",
        "pagesize-32k": "--enable-pagesize-32k",
        "pagesize-64k": "--enable-pagesize-64k",
        "static-libs": "--enable-static",
    },
    src_uri = "https://github.com/gperftools/gperftools/releases/download/gperftools-2.6.1/gperftools-2.6.1.tar.gz",
    sha256 = "38b467eb42a028f253d227fbc428263cb39e6c8687c047466aa2ce5bb4699d81",
    configure_args = [
        "--enable-shared",
        "--enable-static",
    ],
    deps = [
        "system//libs/libunwind:libunwind",
        "core//zlib:zlib",
    ],
)
