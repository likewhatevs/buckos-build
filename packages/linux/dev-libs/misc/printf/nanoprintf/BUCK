load("//defs:package_defs.bzl", "cmake_package")

cmake_package(
    name = "nanoprintf",
    version = "0.4.0",
    src_uri = "https://github.com/charlesnicholson/nanoprintf/archive/1e254afc4fcb97d5a7cf3ce9d029fdfc3ded7d82.tar.gz",
    sha256 = "218943c7c329199c0eb1bef7549a2815bcdf34d0eafa414b749bec95cc589437",
    description = "Tiny header-only printf implementation for embedded systems",
    homepage = "https://github.com/charlesnicholson/nanoprintf",
    license = "Unlicense",
    deps = [],
    pre_configure = """
cat > CMakeLists.txt << 'EOF'
cmake_minimum_required(VERSION 3.10)
project(nanoprintf VERSION 0.4.0 LANGUAGES C CXX)

add_library(nanoprintf INTERFACE)
target_include_directories(nanoprintf INTERFACE
    $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}>
    $<INSTALL_INTERFACE:include>
)

install(FILES nanoprintf.h DESTINATION include)
install(TARGETS nanoprintf EXPORT nanoprintfTargets)
install(EXPORT nanoprintfTargets DESTINATION lib/cmake/nanoprintf)
EOF
""",
    cmake_args = [
        "-DCMAKE_BUILD_TYPE=Release",
    ],
    visibility = ["PUBLIC"],
)
