load("//defs:package_defs.bzl", "autotools_package")

autotools_package(
    name = "zbar",
    version = "0.23.93",
    iuse = [
        "X",
        "dbus",
        "graphicsmagick",
        "gtk",
        "imagemagick",
        "introspection",
        "java",
        "jpeg",
        "nls",
        "python",
        "threads",
        "v4l",
        "xv",
    ],
    use_configure = {
        "-X": "--without-x",
        "-dbus": "--disable-dbus",
        "-graphicsmagick": "--disable-graphicsmagick",
        "-gtk": "--disable-gtk",
        "-imagemagick": "--disable-imagemagick",
        "-introspection": "--disable-introspection",
        "-java": "--disable-java",
        "-jpeg": "--without-jpeg",
        "-nls": "--disable-nls",
        "-python": "--disable-python",
        "-threads": "--disable-threads",
        "-v4l": "--disable-v4l2",
        "-xv": "--disable-xv",
        "X": "--with-x",
        "dbus": "--enable-dbus",
        "graphicsmagick": "--enable-graphicsmagick",
        "gtk": "--enable-gtk",
        "imagemagick": "--enable-imagemagick",
        "introspection": "--enable-introspection",
        "java": "--enable-java",
        "jpeg": "--with-jpeg",
        "nls": "--enable-nls",
        "python": "--enable-python",
        "threads": "--enable-threads",
        "v4l": "--enable-v4l2",
        "xv": "--enable-xv",
    },
    src_uri = "https://github.com/mchehab/zbar/archive/a549566ea11eb03622bd4458a1728ffe3f589163.tar.gz",
    sha256 = "86817215aac09dafa7eda6495f8db1a9b8ce026f0a7a9d8af8b650db1dca999c",
    bdepend = [
        "//packages/linux/dev-tools/build-systems/autoconf:autoconf",
        "//packages/linux/dev-tools/build-systems/automake:automake",
        "//packages/linux/dev-tools/build-systems/libtool:libtool",
        "//packages/linux/dev-libs/misc/gettext:gettext",
    ],
    src_prepare = """
autoreconf -fi
""",
    configure_args = [
        "--enable-pthread",
        "--enable-codes=ean,code128,code39,code93,i25,codabar,databar,pdf417,qrcode,sqcode",
        "--disable-video",
        "--without-jpeg",
        "--without-imagemagick",
        "--without-gtk",
        "--without-qt",
        "--without-qt5",
        "--without-x",
        "--without-dbus",
        "--without-java",
        "--without-npapi",
        "--without-python",
        "--disable-doc",
    ],
    deps = [
        "//packages/linux/dev-libs/iconv:iconv",
    ],
    maintainers = ["buckos"],
)
