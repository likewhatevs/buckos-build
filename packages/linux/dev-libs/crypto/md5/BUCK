load("@root//defs:package_defs.bzl", "cmake_package")

cmake_package(
    name = "md5",
    version = "04d0d68",
    src_uri = "https://github.com/BZFlag-Dev/bzflag/archive/04d0d68acb4960fc056f0c9b662abe82d373e540.tar.gz",
    sha256 = "4b87db0e598902caa7f562442bf0f5028b75e7317a403663190cc9f76f52e251",
    signature_required = False,
    description = "MD5 hash implementation from bzflag",
    homepage = "https://github.com/BZFlag-Dev/bzflag",
    license = "RSA-MD",
    pre_configure = """
# Create CMakeLists.txt for md5 library
cat > CMakeLists.txt << 'EOF'
cmake_minimum_required(VERSION 3.10)
project(md5 CXX)

set(CMAKE_CXX_STANDARD 11)

add_library(md5 SHARED src/md5/md5.cpp)
target_include_directories(md5 PUBLIC
    $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/src>
    $<INSTALL_INTERFACE:include>
)

install(TARGETS md5 LIBRARY DESTINATION lib)
install(FILES src/md5/md5.h DESTINATION include/md5)
EOF
""",
    cmake_args = [
        "-DCMAKE_BUILD_TYPE=Release",
        "-DBUILD_SHARED_LIBS=ON",
    ],
    visibility = ["PUBLIC"],
)
