load("//defs:package_defs.bzl", "autotools_package")

autotools_package(
    name = "hash-library",
    version = "8",
    src_uri = "https://github.com/stbrumme/hash-library/archive/refs/tags/hash_library_v8.tar.gz",
    sha256 = "ddf9d398166e08482af1225aed968ac4c370f99648b5359b0a20c9ed56f7b1c7",
    signature_required = False,
    description = "Portable C++ hashing library (CRC32, MD5, SHA1, SHA256, SHA3, Keccak, HMAC)",
    homepage = "https://create.stephan-brumme.com/hash-library/",
    license = "Zlib",
    src_configure = "true",
    src_compile = """
cd hash-library-8
g++ -std=c++11 -O3 -fPIC -c crc32.cpp -I.
g++ -std=c++11 -O3 -fPIC -c keccak.cpp -I.
g++ -std=c++11 -O3 -fPIC -c md5.cpp -I.
g++ -std=c++11 -O3 -fPIC -c sha1.cpp -I.
g++ -std=c++11 -O3 -fPIC -c sha256.cpp -I.
g++ -std=c++11 -O3 -fPIC -c sha3.cpp -I.
ar rcs libhash-library.a crc32.o keccak.o md5.o sha1.o sha256.o sha3.o
""",
    src_install = """
cd hash-library-8
install -Dm644 libhash-library.a "$DESTDIR/usr/lib/libhash-library.a"
install -Dm644 crc32.h "$DESTDIR/usr/include/hash-library/crc32.h"
install -Dm644 endian.h "$DESTDIR/usr/include/hash-library/endian.h"
install -Dm644 hash.h "$DESTDIR/usr/include/hash-library/hash.h"
install -Dm644 hmac.h "$DESTDIR/usr/include/hash-library/hmac.h"
install -Dm644 keccak.h "$DESTDIR/usr/include/hash-library/keccak.h"
install -Dm644 md5.h "$DESTDIR/usr/include/hash-library/md5.h"
install -Dm644 sha1.h "$DESTDIR/usr/include/hash-library/sha1.h"
install -Dm644 sha256.h "$DESTDIR/usr/include/hash-library/sha256.h"
install -Dm644 sha3.h "$DESTDIR/usr/include/hash-library/sha3.h"
""",
    visibility = ["PUBLIC"],
)
