load("//defs:package_defs.bzl", "cmake_package")

# libnop - C++ Native Object Protocols for serialization

cmake_package(
    name = "libnop",
    version = "2020.01.01",
    src_uri = "https://github.com/google/libnop/archive/35e800d81f28c632956c5a592e3cbe8085ecd430.tar.gz",
    sha256 = "c377bfc07e0029bcd2da23597b9dc668c2450508f57b612fdae0542e097a4f63",
    description = "C++ Native Object Protocols - header-only serialization library",
    homepage = "https://github.com/google/libnop",
    license = "Apache-2.0",
    deps = [],
    pre_configure = """
cat > CMakeLists.txt << 'EOF'
cmake_minimum_required(VERSION 3.10)
project(libnop VERSION 1.0.0 LANGUAGES CXX)

add_library(libnop INTERFACE)
target_include_directories(libnop INTERFACE
    $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include>
    $<INSTALL_INTERFACE:include>
)

install(DIRECTORY include/nop DESTINATION include)
install(TARGETS libnop EXPORT libnopTargets)
install(EXPORT libnopTargets DESTINATION lib/cmake/libnop)
EOF
""",
    cmake_args = [
        "-DCMAKE_BUILD_TYPE=Release",
    ],
    visibility = ["PUBLIC"],
)
