load("@root//defs:package_defs.bzl", "cmake_package")

cmake_package(
    name = "protobuf-c",
    version = "1.5.2",
    iuse = ["static-libs"],
    use_cmake = {
        "-static-libs": "-DBUILD_STATIC_LIBS=OFF",
        "static-libs": "-DBUILD_STATIC_LIBS=ON",
    },
    src_uri = "https://github.com/protobuf-c/protobuf-c/archive/refs/tags/v1.5.2.tar.gz",
    sha256 = "cea46eeaa19c52924938b582c5d128a6ed3b6fb5b3f4677476a1781cc06e03f3",
    deps = [
        "dev-libs//serialization/protobuf:protobuf",
    ],
    cmake_args = [
        "-DCMAKE_BUILD_TYPE=Release",
        "-DBUILD_SHARED_LIBS=ON",
        "-DBUILD_PROTOC=ON",
        "-DBUILD_TESTS=OFF",
    ],
    pre_configure = "cd build-cmake",
    visibility = ["PUBLIC"],
)
