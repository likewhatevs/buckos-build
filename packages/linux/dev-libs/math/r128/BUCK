load("//defs:package_defs.bzl", "cmake_package")

cmake_package(
    name = "r128",
    version = "1.0",
    src_uri = "https://github.com/fahickman/r128/archive/refs/heads/main.tar.gz",
    sha256 = "2986f776ed5006aea941a28354de0957424758fa47c5e502615b85597f5fc2db",
    description = "128-bit signed integer library for C",
    homepage = "https://github.com/fahickman/r128",
    license = "Unlicense",
    pre_configure = """
cat > CMakeLists.txt << 'EOF'
cmake_minimum_required(VERSION 3.10)
project(r128 VERSION 1.0 LANGUAGES C)

add_library(r128 STATIC r128.c)
target_include_directories(r128 PUBLIC
    $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}>
    $<INSTALL_INTERFACE:include>
)

install(TARGETS r128 ARCHIVE DESTINATION lib)
install(FILES r128.h DESTINATION include)
EOF
""",
    cmake_args = [
        "-DCMAKE_POLICY_VERSION_MINIMUM=3.5",
    ],
    visibility = ["PUBLIC"],
)
