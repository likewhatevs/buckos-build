load("@root//defs:package_defs.bzl", "cmake_package")

cmake_package(
    name = "libzip",
    version = "1.11.4",
    iuse = [
        "bzip2",
        "gnutls",
        "lzma",
        "mbedtls",
        "ssl",
        "tools",
        "zstd",
    ],
    use_cmake = {
        "-bzip2": "-DENABLE_BZIP2=OFF",
        "-gnutls": "-DENABLE_GNUTLS=OFF",
        "-lzma": "-DENABLE_LZMA=OFF",
        "-mbedtls": "-DENABLE_MBEDTLS=OFF",
        "-ssl": "-DENABLE_SSL=OFF",
        "-tools": "-DENABLE_TOOLS=OFF",
        "-zstd": "-DENABLE_ZSTD=OFF",
        "bzip2": "-DENABLE_BZIP2=ON",
        "gnutls": "-DENABLE_GNUTLS=ON",
        "lzma": "-DENABLE_LZMA=ON",
        "mbedtls": "-DENABLE_MBEDTLS=ON",
        "ssl": "-DENABLE_SSL=ON",
        "tools": "-DENABLE_TOOLS=ON",
        "zstd": "-DENABLE_ZSTD=ON",
    },
    src_uri = "https://github.com/nih-at/libzip/releases/download/v1.11.4/libzip-1.11.4.tar.xz",
    sha256 = "8a247f57d1e3e6f6d11413b12a6f28a9d388de110adc0ec608d893180ed7097b",
    deps = [
        "dev-libs//compression:zlib",
    ],
    cmake_args = [
        "-DCMAKE_BUILD_TYPE=Release",
        "-DENABLE_COMMONCRYPTO=OFF",
        "-DENABLE_GNUTLS=OFF",
        "-DENABLE_MBEDTLS=OFF",
        "-DENABLE_OPENSSL=OFF",
    ],
    visibility = ["PUBLIC"],
)
