load("//defs:package.bzl", "package")

# NumPy - Fundamental package for scientific computing with Python
#
# NumPy is built using Meson and requires BLAS/LAPACK for optimized
# linear algebra operations.
#
# USE flags:
#   openblas  - Use OpenBLAS for BLAS/LAPACK
#   simd      - Enable SIMD optimizations (AVX, SSE, etc.)

package(
    build_rule = "python",
    name = "numpy",
    version = "1.26.4",
    url = "https://github.com/numpy/numpy/releases/download/v1.26.4/numpy-1.26.4.tar.gz",
    sha256 = "2a02aba9ed12e4ac4eb3ea9421c420301a0c6460d9830d74a9df87efa4912010",
    description = "Fundamental package for array computing with Python",
    homepage = "https://numpy.org/",
    license = "BSD-3-Clause",
    use_configure = {
        "big-endian": ("--enable-big-endian", "--disable-big-endian"),
        "cpudetection": ("--enable-cpudetection", "--disable-cpudetection"),
        "index64": ("--enable-index64", "--disable-index64"),
        "lapack": ("--enable-lapack", "--disable-lapack"),
    },
    deps = [
        "//packages/linux/lang/python:python",
    ],
    use_deps = {
        "openblas": "//packages/linux/dev-libs/math/openblas:openblas",
    },
    env = {
        "NPY_BLAS_ORDER": "openblas",
        "NPY_LAPACK_ORDER": "openblas",
    },
)
