"""
Host tools for the hermetic seed toolchain.

The bootstrap configuration transition (applied by toolchain_export on
the host_tools dep) flips the toolchain to host PATH tools, so these
packages build without depending on the seed — breaking the cycle.

The host_tools_aggregator merges all package bin dirs into one flat
directory that becomes the seed's hermetic PATH.

Add more tools here as hermeticity testing reveals missing ones:
  1. buck2 build //packages/linux/core/zlib:zlib
  2. Fails: "foo: not found" → add the package providing foo below
  3. Repeat until hermetic
"""

load(":defs.bzl", "host_tools_aggregator")

host_tools_aggregator(
    name = "host-tools",
    packages = [
        # Shell
        "//packages/linux/core/bash:bash",

        # Core utilities
        "//packages/linux/system/apps/coreutils:coreutils",
        "//packages/linux/system/apps/findutils:findutils",
        "//packages/linux/system/apps/tar:tar",
        "//packages/linux/system/apps/which:which",
        "//packages/linux/editors/diffutils:diffutils",
        "//packages/linux/editors/sed:sed",
        "//packages/linux/editors/grep:grep",
        "//packages/linux/editors/gawk:gawk",
        "//packages/linux/editors/patch:patch",
        "//packages/linux/core/file:file",
        "//packages/linux/core/util-linux:util-linux",

        # Compression
        "//packages/linux/system/libs/compression/gzip:gzip",
        "//packages/linux/system/libs/compression/xz:xz",
        "//packages/linux/system/libs/compression/bzip2:bzip2",
        "//packages/linux/system/libs/compression/zstd:zstd",

        # Binary utilities (strip, objcopy, ar, as, ld, etc.)
        "//packages/linux/dev-tools/build-systems/binutils:binutils",

        # Native C/C++ compiler (needed by Kconfig, kernel builds, etc.)
        "//packages/linux/lang/gcc:gcc-native",

        # GCC dependencies (libs must be in merged tree for gcc to find them)
        "//packages/linux/system/libs/utility/gmp:gmp",
        "//packages/linux/system/libs/utility/mpfr:mpfr",
        "//packages/linux/system/libs/utility/mpc:mpc",

        # Linker
        "//packages/linux/lang/linkers:mold",

        # Build systems
        "//packages/linux/dev-tools/build-systems/make:make",
        "//packages/linux/dev-tools/build-systems/cmake:cmake",
        "//packages/linux/dev-tools/build-systems/ninja:ninja",
        "//packages/linux/dev-tools/build-systems/meson:meson",
        "//packages/linux/dev-tools/build-systems/m4:m4",
        "//packages/linux/dev-tools/build-systems/autoconf:autoconf",
        "//packages/linux/dev-tools/build-systems/automake:automake",
        "//packages/linux/dev-tools/build-systems/libtool:libtool",
        "//packages/linux/dev-tools/build-systems/pkg-config:pkg-config",

        # Dev utilities
        "//packages/linux/dev-tools/dev-utils/bison:bison",
        "//packages/linux/dev-tools/dev-utils/flex:flex",

        # ELF / DWARF
        "//packages/linux/system/libs/elfutils:elfutils",
        "//packages/linux/dev-tools/dev-utils/dwarves:dwarves",

        # Internationalization
        "//packages/linux/dev-libs/misc/gettext:gettext",

        # Kernel module tools
        "//packages/linux/system/libs/kmod:kmod",

        # Languages
        "//packages/linux/lang/perl:perl",
        "//packages/linux/lang/python:python",
        "//packages/linux/lang/rust:rust",
        "//packages/linux/lang/go:go",

        # ISO image tools (xorriso)
        "//packages/linux/dev-libs/iso/libisoburn:libisoburn",

        # Image / filesystem tools
        "//packages/linux/system/filesystem/native/squashfs-tools:squashfs-tools",
        "//packages/linux/system/filesystem/native/e2fsprogs:e2fsprogs",
        "//packages/linux/system/filesystem/native/dosfstools:dosfstools",
        "//packages/linux/system/libs/cpio:cpio",
        "//packages/linux/boot/grub:grub",
        "//packages/linux/emulation/hypervisors/qemu:qemu",

        # Documentation tools (needed by bison, automake, etc.)
        "//packages/linux/dev-tools/documentation/help2man:help2man",

        # Security / signing
        "//packages/linux/system/security/ima-evm-utils:ima-evm-utils",
    ],
    visibility = ["PUBLIC"],
)
